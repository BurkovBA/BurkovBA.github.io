---
title: DeepMind - Презентация AlphaFold в EBI
date: "2019-02-07T00:00:00.284Z"
tags: ["how-life-works", "math", "biomed", "programming"]
cover: "./Origami-CASP-folding.gif"
description: Два месяца назад весь мир облетела новость, что DeepMind выиграл известное соревнование по предсказанию 3D-структур белков CASP, порвав всех биоинформатиков с впечатляющим отрывом. Многие люди из мира биотеха теперь пытаются осознать, 'что это было': революция или эволюция, наука или инженерия, талант или финансирование? Волею судеб я когда-то оказался совсем недалеко от этой области науки, поэтому потратил несколько дней чтобы разобраться в деталях - а между тем в EBI приехал наводить мосты ведущий инженер проекта Эндрю Сеньор из DeepMind.
---

<div>
  <img src={birneyAndSenior} className="img-responsive center-block" />
  <div className="caption text-center">Ведущий разработчик AlphaFold Эндрю Сеньор (слева) и директор EMBL-EBI Юэн Бирни (справа)</div>
  <h2>Что вообще произошло?</h2>
  <p>
    В этом посте я сначала расскажу, что такое CASP и зачем его проводят, потом постараюсь
    быстро обрисовать как решали эту задачу раньше, и за счет чего победил DeepMind. А потом поговорим о том, где
    заканчивается наука и начинается инженерия, и как ими заниматься в академии и индустрии.
  </p>
  <h2>
    Какую проблему решал DeepMind?
  </h2>
  <p>
    Основную работу в наших клетках осуществляют белки. Белки состоят из последовательности аминокислот
    (например, "MAKFGEWTTPFTNS" - всего бывает 20 разных аминокислот, каждой соответствует своя буква вроде "M" -
    метионин). Прочитать последовательность белка очень дешево, но расшифровать 3D-структуру белка (как та, что на
    обложке этой статьи) крайне дорого и трудоемко. Но именно 3D-структура содержит ценную информацию для синтеза
    новых лекарств - например, по ней можно подобрать вещества, которые связываются с этим белком и подавляют его
    функцию - такие вещества могут стать новыми лекарствами.
  </p>
  <p>
    Хорошо, а как насчет всяких законов Ньютона и т.п.: если мы знаем последовательность белка, может быть
    мы сможем предсказать, как свернется белок в пространстве просто под действием сил? Не получается.
    Куча бывших физиков и математиков, сбежавшихся в биоинформатику, десятилетиями бились с этой задачей
    практически безрезультатно. Около 25 лет назад был создан конкурс CASP - Critical Assessment of Protein
    Structures - где участникам предлагалось предсказать 3D-структуру белка по последовательности.
  </p>
  <p>
    После 10 лет стагнации, на CASP'10 в 2012 был достигнут большой прогресс. Известно было, что у одного и того
    же белка в разных видах меняется последовательность (например, пока человек происходил из обезьяны, пара
    аминокислот в альбмуине у него изменилась). Однако пространственная структура белков даже при изменении
    последоавтельности меняется довольно слабо. Тогда этот факт можно использовать: люди додумались смотреть на
    коэволюцию аминокислот. Например, если в человеческой версии белка в одном месте последовательности была
    положительно заряженная аминокислота, а в другом - отрицательно, а у аналогичного белка из обезьяны - наоборот,
    то можно предположить, что эти аминокислоты неспроста так коэволюционируют - видимо, они взаимодействуют, а
    значит, сближены в пространстве.
  </p>
  <img src="http://mistic.leloir.org.ar/docs/MIexplained.png" className="img-responsive center-block" />
  <div className="caption text-center">
    Слева в строках записаны последовательности одного и того же белка из разных видов (например, первая строка
    "ACPRLDVDSQ" - из человека, вторая - "ACPR-EVDCN" - из обезьяны и т.д. - это называется выравнивание). Видно,
    что в тех видах, где четвертая аминокислота изменилась, изменилась и восьмая.
  </div>
  <p>
    Записывая однотипные белки друг под другом, биоинформатики стали строить так называемые выравнивания, и
    выводить из них структуры белков.
  </p>
  <p>
    Спустя несколько лет появилась идея, где можно достать гораздо больше данных для вычисления коэволюции:
    появилась метагеномика. Дело в том, что большинство организмов, последовательности генов которых нам известны,
    хорошо культивируются в лабораторных условиях. Но, к примеру, среди бактерий основную массу культивировать
    не выходит.
  </p>
  <p>
    Поэтому вместо того, чтобы пытаться выделить одну бактерию и отсеквенировать именно ее, народ стал просто
    "зачерпывать" ДНК из окружающей среды и секвенировать (прочитанная из среды ДНК стала называться метагеномной)
    - и в этом бульоне оказалось гораздо больше разнообразия белков, чем было известно до этого. Сергей
    Овчинников из Гарварда придумал, что это разнообразие можно использовать и для получения данных о коэволюции
    - и предсказания удалось улучшить еще больше.
  </p>
  <p>
    Затем в районе 2016 - CASP'12 - случилась новая революция: все стали использовать нейронки для оптимизации
    структур. Со временем устоялся более-менее один и тот же подход.
  </p>
  <img src="https://moalquraishi.files.wordpress.com/2018/12/casp13-gdt_ts1.png" className="img-responsive center-block" />
  <div className="caption text-center">
    Кривые показывают результаты победителя и второго призера CASP, курсивом выделен ожидавшийся результат
    победителя CASP13, если бы сохранялись темпы прогресса с CASP11 и CASP12. Доверительные интервалы - 95%,
    оценка резульатов победителей по версии организаторов конкурса (там разные лаборатории предлагают несколько
    разные оценки результатов). Взято из прекрасного <a href="https://moalquraishi.wordpress.com/2018/12/09/alphafold-casp13-what-just-happened/">блог поста Мохаммеда Аль-Краиши</a>.
  </div>
  <p>
    К началу CASP'13 несколько научных групп сообразили, что про каждую пару остатков нужно говорить
    не просто сближены они или нет, а стараться определить расстояние. И тут бы одна из групп-пионеров в этой
    области и победила... Но на сцену ворвался DeepMind.
  </p>
  <h2>Как все было?</h2>
  <p>
    Все началось как хакатон. Один из сотрудников DeepMind для интереса попробовал за выходные запустить
    предсказание 3D-структуры белка, и добился неплохих результатов.
  </p>
  <p>
    Затем сотрудники DeepMind пообщались со структурным биоинформатиком и соавтором системы классификации
    пространственных структур CATH <a href="https://www.crick.ac.uk/research/labs/david-jones">Дэвидом Джонсом</a> из
    Crick Institute при University College London (там в свое время переучивался на машиниста Демис Хассабис).
    Тот объяснил им, как устроен современный биоинформатический пайплайн предсказания 3D-структур белков.
  </p>
  <img src={pipeline} className="img-responsive center-block" />
  <div className="caption text-center">Современный пайплайн предсказания 3D-структуры белков</div>
  <p>
    Ребята из DeepMind не стали сильно заморачиваться с биологией, и сразу взялись за серединку этого пайплайна -
    нейронную сетку - и инженерию фич для нее.
  </p>
  <p>
    Я не смогу пересказать всего, что сделала эта команда. Они перебрали около сотни разных структур нейронок и
    остановились вот на такой:
  </p>
  <img src={neuralNetwork} className="img-responsive center-block" />
  <div className="caption text-center">Deep Dilated Convolutional Residual Network</div>
  <p>
    В качестве обучающей выборки они взяли все извесные структуры из главной мировой бызы 3D-структр PDB, которая
    содержит в себе около 150 тысяч структур, но большинство из них сильно повторяются, так что реальный размер
    выборки составлял лишь порядка 30 тысяч структур. Это очень мало для машинного обучения.
  </p>
  <img src={dataset} className="img-responsive center-block" />
  <div className="caption text-center">Датасет из PDBe (EBI-евская база данных 3D-структур)</div>
  <p>
    Поэтому они сделали изящную аугментацию данных, "пошатав" отдельные спирали и листы известных 3D-структур, что,
    кстати, вполне соответствует биологической природе белков - они так в растворе и шатаются.
  </p>
  <p>
    Они придумали также огромное количество других приемчиков. Они хитрили с определением границ доменов. Они
    заменили матрицу расстояний между остатками на матрицу распределений расстояний. Они посреди конкурса поменяли
    градиент с симулированного отжига на l-BFGS. Они колдовали с торсионными углами в белках, чтобы сделать их
    реалистичными...
  </p>
  <img src={distograms} className="img-responsive center-block" />
  <div className="caption text-center">Дистограммы - распределения расстояний между аминоксилотами</div>
  <h2>И что дальше?</h2>
  <p>
    DeepMind готовит по работе публикацию. Они довольно свободно и подробно рассказывают о том, что было сделано,
    но не планируют пока публиковать исходный код. По слухам это объясняется тем, что они еще не все выжали из
    выбранного подхода и могут сделать еще лучше. Кроме того, они ничего не понимают в биологии, а после всех
    неимоверных усилий, что были затрачены, кажется, обидно не получить за них какое-то вознаграждение. В EBI они
    по этому поводу усиленно наводили мосты и интересовались, к кому бы теперь с этим молотком пойти за гвоздями.
  </p>
  <h2>Так все же что это было?</h2>
  <p>
    Это была абсолютно титаническая инженерная работа. Они практически не коснулись биологии совсем,
    почти ничего нового не придумали. Просто очень, очень хорошо исполнили machine learning'овую часть и положили
    на нее очень много усилий превосходных инженеров. По-видимому, к чему-то подобному шла и биоинформатика, и
    наверное к следующему-позаследующему CASP'у пришла бы и независимо. Победа DeepMind - это не революция, а
    эволюция и преимущественно не фундаментальная наука, а виртуозная инженерия.
  </p>
  <p>
    В соавторах работы 15+ человек, по-видимому, основной вклад внесли шестеро. Сам Эндрю Сеньор занимался
    нейронками еще с 1994 года - представьте, какой колоссальный опыт был накоплен им за четверть века.
  </p>
  <p>
    Очень советую также прочитать <a href="https://moalquraishi.wordpress.com/2018/12/09/alphafold-casp13-what-just-happened/">
    вот этот блестящий блог пост</a> - там один из специалистов в данной области очень
    понятным языком рассказывает обо всем случившемся, я много информации почерпнул именнно у него.
  </p>
</div>